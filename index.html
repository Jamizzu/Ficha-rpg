<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Formulário RPG</title>
  <style>
    .question {
      display: none;
    }

    .question.active {
      display: block;
    }

    #mensagemFinal.show {
      margin-top: 20px;
      font-size: 1.2em;
      color: green;
    }

    button {
      margin-top: 10px;
    }
  </style>
</head>
<body>

  <form id="rpgForm" class="container">
    <div class="question active">
      <label for="nome">Qual seu nome?</label>
      <input type="text" name="nome" required>
      <button type="button" class="nextBtn">Próxima</button>
    </div>

    <div class="question">
      <label for="historia">Conte sua história.</label>
      <textarea name="historia" required></textarea>
      <button type="button" class="nextBtn">Próxima</button>
    </div>

    <div class="question">
      <label for="final">Finalização</label>
      <input type="text" name="final" required>
      <button type="submit">Enviar</button>
    </div>
  </form>

  <div id="mensagemFinal"></div>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      let current = 0;
      const questions = document.querySelectorAll(".question");
      const total = questions.length;
      const form = document.getElementById("rpgForm");
      const mensagemFinal = document.getElementById("mensagemFinal");

      function nextQuestion() {
        const inputAtual = questions[current].querySelector('input, textarea');
        if (!inputAtual.checkValidity()) {
          inputAtual.reportValidity();
          return;
        }

        questions[current].classList.remove("active");
        current++;

        if (current < total) {
          questions[current].classList.add("active");

          setTimeout(() => {
            questions[current].scrollIntoView({ behavior: "smooth", block: "center" });
          }, 150);
        }
      }

      document.querySelectorAll("button.nextBtn").forEach(btn => {
        btn.addEventListener("click", nextQuestion);
      });

      form.addEventListener("submit", function (e) {
        e.preventDefault();

        const inputAtual = questions[current].querySelector('input, textarea');
        if (!inputAtual.checkValidity()) {
          inputAtual.reportValidity();
          return;
        }

        const formData = new FormData(form);
        const nome = formData.get("nome") || "Usuário";

        fetch("https://formspree.io/f/xblovjbb", {
          method: "POST",
          body: formData,
          headers: { 'Accept': 'application/json' }
        })
        .then(response => {
          if (response.ok) {
            form.style.display = "none";
            mensagemFinal.innerHTML = `Entraremos em contato em breve, <strong>${nome.toUpperCase()}</strong>.`;
            mensagemFinal.classList.add("show");
            mensagemFinal.scrollIntoView({ behavior: "smooth", block: "center" });
          } else {
            return response.json().then(data => {
              throw new Error(data.error || "Erro ao enviar formulário.");
            });
          }
        })
        .catch((err) => {
          alert("Erro ao enviar. Tente novamente.");
          console.error(err);
        });
      });
    });
  </script>

</body>
</html>
